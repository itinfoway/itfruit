<section>
    <div class="container my-container steps">
        <div class="row">
            <div class="col-sm-12 col-md-3">
                <div class="step step-1">
                    <div class="step-text">
                        <h6>1</h6>
                        <h6>NUTRITICON</h6>
                        <h6>PACKS</h6>
                    </div>
                </div>
            </div>
            <div class="arrow">
                <img class="img-responsive" src="<?= base_url() ?>assert/fontend/img/arrow-1.png">
            </div>
            <div class="col-sm-12 col-md-3">
                <div class="step step-2">
                    <div class="step-text">
                        <h6>2</h6>
                        <h6>YOUR</h6>
                        <h6>ORDER</h6>
                    </div>
                </div>
            </div>
            <div class="arrow">
                <img class="img-responsive" src="<?= base_url() ?>assert/fontend/img/arrow-2.png">
            </div>
            <div class="col-sm-12 col-md-3">
                <div class="step step-3">
                    <div class="step-text">
                        <h6>3</h6>
                        <h6>DELIVERY</h6>
                        <h6>INFORMATION</h6>
                    </div>
                </div>
            </div>
            <div class="arrow">
                <img class="img-responsive" src="<?= base_url() ?>assert/fontend/img/arrow-3.png">
            </div>
            <div class="col-sm-12 col-md-3">
                <div class="step step-4">
                    <div class="step-text">
                        <h6>4</h6>
                        <h6>CHECKOUT</h6>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section>

    <div class="container-fluid">
        <div class="date-time">
            <div class="row">
                <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-2" id="orderbox1">
                    <center><img style="height: 80px;" src="<?= base_url(); ?>assert/fontend/img/pinapple.svg"></center>
                    <img class="date-close pointer" src="<?= base_url(); ?>assert/fontend/img/date-close.png">
                    <div class="date-part pointer"  data-date="1" data-itme-value="">
                        <div class="time">
                            <div>
                                <spna class="input-group-addon">
                                    <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/date.png">
                                </spna>
                                <p class="order-date"></p>
                                <p class="order-year"></p>
                            </div>
                            <div>
                                <div class="order">
                                    <div class="text">
                                        <p>order</p>
                                        <p>1</p>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/time.png">
                                <p class="order-time"></p>
                            </div>
                        </div>
                        <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/line.png" width="45%" height="3px">
                        <div class="data-items">
                        </div>
                    </div>
                    <h5 class="pl-3 text-center credit" style="display: none"><span>0</span> CREDIT</h5>
                </div>

                <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-2" id="orderbox2">
                    <center><img style="height: 80px;" src="<?= base_url(); ?>assert/fontend/img/grapes.svg"></center>
                    <img class="date-close pointer" src="<?= base_url(); ?>assert/fontend/img/date-close.png">
                    <div class="date-part pointer"  data-date="2" data-itme-value="">
                        <div class="time">
                            <div>
                                <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/date.png">
                                <p class="order-date"></p>
                                <p class="order-year"></p>
                            </div>
                            <div>
                                <div class="order">
                                    <div class="text">
                                        <p>order</p>
                                        <p>2</p>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/time.png">
                                <p class="order-time"></p>
                            </div>
                        </div>
                        <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/line.png" width="45%" height="3px">
                        <div class="data-items">
                        </div>
                    </div>
                    <h5 class="pl-3 text-center credit" style="display: none"><span>0</span> CREDIT</h5>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-2" id="orderbox3">
                    <center><img style="height: 80px;" src="<?= base_url(); ?>assert/fontend/img/berry.svg"></center>
                    <img class="date-close pointer" src="<?= base_url(); ?>assert/fontend/img/date-close.png">
                    <div class="date-part pointer"  data-date="3" data-itme-value="">
                        <div class="time">
                            <div>
                                <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/date.png">
                                <p class="order-date"></p>
                                <p class="order-year"></p>
                            </div>
                            <div>
                                <div class="order">
                                    <div class="text">
                                        <p>order</p>
                                        <p>3</p>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/time.png">
                                <p class="order-time"></p>
                            </div>
                        </div>
                        <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/line.png" width="45%" height="3px">
                        <div class="data-items">
                        </div>
                    </div>
                    <h5 class="pl-3 text-center credit" style="display: none"><span>0</span> CREDIT</h5>
                </div>
                <div class=" col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-2" id="orderbox4">
                    <center><img style="height: 80px;" src="<?= base_url(); ?>assert/fontend/img/orange.svg"></center>
                    <img class="date-close pointer" src="<?= base_url(); ?>assert/fontend/img/date-close.png">
                    <div class="date-part pointer"  data-date="4" data-itme-value="">
                        <div class="time">
                            <div>
                                <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/date.png">
                                <p class="order-date"></p>
                                <p class="order-year"></p>
                            </div>
                            <div>
                                <div class="order">
                                    <div class="text">
                                        <p>order</p>
                                        <p>4</p>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/time.png">
                                <p class="order-time"></p>
                            </div>
                        </div>
                        <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/line.png" width="45%" height="3px">
                        <div class="data-items">
                        </div>
                    </div>
                    <h5 class="pl-3 text-center credit" style="display: none"><span>0</span> CREDIT</h5>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-2" id="orderbox5">
                    <center><img style="height: 80px;" src="<?= base_url(); ?>assert/fontend/img/sitafal.svg"></center>
                    <img class="date-close pointer" src="<?= base_url(); ?>assert/fontend/img/date-close.png">
                    <div class="date-part pointer"  data-date="5" data-itme-value="">
                        <div class="time">
                            <div>
                                <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/date.png">
                                <p class="order-date"></p>
                                <p class="order-year"></p>
                            </div>
                            <div>
                                <div class="order">
                                    <div class="text">
                                        <p>order</p>
                                        <p>5</p>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/time.png">
                                <p class="order-time"></p>
                            </div>
                        </div>
                        <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/line.png" width="45%" height="3px">
                        <div class="data-items">
                        </div>
                    </div>
                    <h5 class="pl-3 text-center credit" style="display: none"><span>0</span> CREDIT</h5>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 col-xl-2">
                    <center><img style="height: 80px;" src="<?= base_url(); ?>assert/fontend/img/banana.svg"></center>
                    <div class="totel">
                        <p>total: <span id="creditTotal">0</span> credit</p>
                    </div>
                    <div class="totel">
                        <p>checkout</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div class="modal fade"  tabindex="-1" role="dialog" aria-labelledby="dateAndTime1Label" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <img src="<?= base_url() ?>assert/fontend/img/date-close.png"/>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group col-8 offset-2">
                    <label>Select Date</label>
                    <input class="form-control form_datetime" data-date-format="dd M yyyy" data-date="<?= date('Y-m-d', strtotime(date('Y-m-d') . " +1 days")); ?>" size="16" type="text" value="" data-link-field="orderbox" readonly>
                    <input  type="hidden" id="orderbox" name="orderbox" >
                </div>
                <div class="form-group col-8 offset-2" style="display:none">
                    <label>Select Time</label>
                    <select class="form-control" id="gettime">
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="savedate" class="btn btn-primary"  data-dismiss="modal" aria-label="Close">Save</button>
            </div>
        </div>
    </div>
</div>
<?= form_open() ?>
<input type="hidden" name="address" id="addresInput">
<section>
    <div class="remark">
        <div class="container my-container">
            <p>SPECIAL REQUEST <span> ? </span> REMARK</p>
            <textarea spellcheck="false" name="remark"></textarea>
            <p><span>*</span> PLEASE CHANGE YOGURT TO DARK CHOCOLATE SAUCE</p>
            <p><span>*</span> WE WILL TRY OUR BEST TO ACCOMMODATE, OTHERWIAE OUR CUATOMER SERVICE WILL GIVE YOU A CALL.</p>
        </div>
    </div>
</section>
<section>
    <div class="container my-container">
        <div class="bill-pay">
            <div class="row">
                <div class="col-sm-6">
                    <div class="billing">
                        <img class="fruits strawberry" src="<?= base_url() ?>assert/fontend/img/strawberry.svg">
                        <img class="fruits sitafal" src="<?= base_url() ?>assert/fontend/img/sitafal.svg">
                        <h4 class="add-address-select">Select Address</h4>
                        <!--  <div class="add-address">
                             <a href="<?= base_url("address/add"); ?>">
                                 <center>
                                     <h1>Add New Address</h1>
                                 </center>
                             </a>
                         </div> -->
                        <div class="add-part">
                            <div class="row">
                                <?php
                                foreach ($address as $d) {
                                    ?>
                                    <div class="col-sm-12">
                                        <div class="text-part">
                                            <div class="row">

                                                <?php
                                                if ($d->type == 1) {
                                                    ?>
                                                    <div class="col-xs-3">
                                                        <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/home.png">
                                                    </div>
                                                    <div class="col-xs-6`">
                                                        <p>Home</p>
                                                    </div>
                                                    <?php
                                                } else if ($d->type == 2) {
                                                    ?>
                                                    <div class="col-xs-3">
                                                        <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/office.png">
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>Work</p>
                                                    </div>
                                                    <?php
                                                } else if ($d->type == 3) {
                                                    ?>
                                                    <div class="col-xs-3">
                                                        <img class="img-responsive" src="<?= base_url(); ?>assert/fontend/img/location.svg">
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <p>Other</p>
                                                    </div>
                                                    <?php
                                                }
                                                ?>
                                                <div class="col-xs-3">
                                                    <button type="button" data-value="<?= urlencode(base64_encode($d->id)); ?>" class="btn btn-default select">select</button>
                                                </div>

                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12">
                                                    <div class="location">
                                                        <p><?= $d->address1 ?></p>
                                                        <p><?= $d->address2 ?></p>
                                                        <p><?= $d->city ?>-<?= $d->postalcode ?>, <?= $d->state ?></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="buttons">
                                                    <div class="col-xs-6">
                                                        <a href="<?= base_url("address/edit/" . urlencode(base64_encode($d->id))); ?>"><button class="edit-btn" type="button">EDIT</button></a>
                                                    </div>
                                                    <div class="col-xs-6">
                                                        <button class="remove-btn" type="button">REMOVE</button>
                                                    </div>
                                                    <div class="clearfix"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <?php
                                }
                                ?>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="billing payment-part"><grammarly-extension class="_1KJtL" style="position: absolute; top: 0px; left: 0px; pointer-events: none;"><div data-grammarly-part="highlights" class="u_fNK" style="position: absolute; top: 0px; left: 0px;"><div style="box-sizing: content-box; top: 465px; left: 72px; width: 530.5px; height: 190px; position: relative; pointer-events: none; overflow: hidden; border: 0px; border-radius: 0px; padding: 0px; margin: 0px;"><div style="position: absolute; top: 0px; left: 0px;"><div style="height: 918px; width: 1897px;"><div></div><div></div></div></div></div></div><div data-grammarly-part="button" class="u_fNK" style="position: absolute; top: 0px; left: 0px;"><div style="box-sizing: content-box; top: 465px; left: 72px; width: 530.5px; height: 190px; position: relative; pointer-events: none; overflow: hidden; border: 0px; border-radius: 0px; padding: 0px; margin: 0px;"><div style="position: absolute; transform: translate(-100%, -100%); top: 182px; left: 492.5px; width: auto; height: auto; pointer-events: all;"><div style="flex-direction: row; display: flex; pointer-events: auto;"><div style="position: relative;"></div><div><div class="_5WizN _1QzSN"><div class="_3YmQx"><div title="Protected by Grammarly" class="_3QdKe">&nbsp;</div></div></div></div></div></div></div></div></grammarly-extension>
                        <img class="fruits pinapple" src="<?= base_url() ?>assert/fontend/img/pinapple.svg">
                        <img class="fruits orange" src="<?= base_url() ?>assert/fontend/img/orange.svg">
                        <h4>PAYMENT METHOD</h4>
                        <center><img class="img-responsive" src="<?= base_url() ?>assert/fontend/img/line.png" width="50%" height="3px"></center>
                        <h1>PLEASE SELECT THE PREFERRED PAYMENT METHOD TO USE ON THIS ORDER.</h1>
                        <p><img src="<?= base_url() ?>assert/fontend/img/wallet-white.svg" width="10%"> <?= $this->lang->line("fn_cu_credit") ?> : <?= $wallet[0]->cr ?> <?= $this->lang->line("fn_credit") ?></p>

                        <p><img src="<?= base_url() ?>assert/fontend/img/credit-card.svg" width="10%" class="px-2"> <?= $this->lang->line("fn_re_credit") ?> : <font class="text-danger"> <spam id="debitTotal"></spam> <?= $this->lang->line("fn_debit") ?></font></p>

                        <div class="comment">
                            <p>ADD COMMENTS ABOUS YOUR ORDER</p>
                            <p>( FOR COMMENTS ABOUT FOOD OR PAID MVP DELIVERY TIMING SLOTS ONLY )</p>
                            <textarea spellcheck="false" name="comment"></textarea>
                        </div>
                    </div>
                    <div class="c-out">
                        <button type="submit">CHECKOUT</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<?= form_close() ?>
<?php
$this->session->set_userdata('previous_url', current_url());
?>
<script src="<?= base_url(); ?>assert/fontend/js/bootstrap-datetimepicker.min.js"></script>
<script>
    $(document).on("keyup", "textarea[name='remark']", function () {
        setCookie("remark", $(this).val());
    });
    $(document).on("keyup", "textarea[name='comment']", function () {
        setCookie("comment", $(this).val());
    });

    $("form").submit(function (event) {
        var debit = parseInt($("#debitTotal").text());
        var credit = parseInt("<?= $wallet[0]->cr ?>");
        if (debit <= credit) {
            $("input[name='<?= $this->security->get_csrf_token_name() ?>']").val(getCookie('<?= $this->security->get_csrf_token_name() ?>'));
            return true;
        } else {
            toastr.error('<?= $this->lang->line("fn_error_credit_debit") ?>');
            window.location.href = '<?= base_url("wallet/add-to-cart"); ?>';
            return false;
        }
    });
    var error_order_carte_not_set = "<?= $this->lang->line("fn_error_order_carte_not_set"); ?>";
    $('.form_datetime').datetimepicker({
        daysOfWeekDisabled: "6,0",
        weekStart: 1,
        todayBtn: 1,
        autoclose: 1,
        startDate: '<?= date('Y-m-d', strtotime(date('Y-m-d') . " +1 days")); ?>',
        todayHighlight: 1,
        startView: 2,
        minView: 2,
    });
    function getTime() {
        var date = $("#orderbox").val();
        return $.ajax({
            url: "<?= base_url("ala-cart-sliced/gettime") ?>",
            type: 'Post',
            data: {
<?= $this->security->get_csrf_token_name(); ?>: getCookie('<?= $this->security->get_csrf_token_name(); ?>'),
                date: date
            },
            dataType: "json",
            async: false,
            success: function (respText) {
                $("#gettime").html("");
                if (Object.keys(respText).length > 0) {
                    for (id in respText.time) {
                        $("#gettime").append("<option value='" + id + "' data-item='" + respText.time[id].min_item + "'>" + respText.time[id].time + "</option>")
                    }
                    $("#gettime").parent("div").show();
                } else {
                    toastr.error('<?= $this->lang->line("fn_error_today_order_stock") ?>');
                    $("#gettime").parent("div").hide();
                }
            }
        });
    }
    $(document).ready(function () {
        $(".billing").find(".select:first").click();
        if (getCookie("remark") != "") {
            $("textarea[name='remark']").text(getCookie("remark"));
        }
        if (getCookie("comment") != "") {
            $("textarea[name='comment']").text(getCookie("comment"));
        }
    });

    $(document).on("click", ".select", function () {
        var data = $(this).data("value");
        $(".billing").find(".select").removeClass("active");
        $(this).addClass("active");
        $("#addresInput").val(data);
    });

</script>
<script>
    $(document).on("click", ".remove-btn", function () {
        var id=$(this).data("id");
        
        bootbox.confirm({
            message: "<?= $this->lang->line("fn_delete_confirm_msg"); ?>",
            buttons: {
                confirm: {
                    label: 'Yes',
                    className: 'btn-success'
                },
                cancel: {
                    label: 'No',
                    className: 'btn-danger'
                }
            },
            callback: function (result) {
                if (result) {
                    window.location.href = '<?= base_url("address/delete/"); ?>'+id;
                }
            }
        });
    });

</script>
<script src="<?= base_url() ?>assert/fontend/js/ala-carte.js"></script>